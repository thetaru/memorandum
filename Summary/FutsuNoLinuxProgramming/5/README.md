# ストリームにかかわるシステムコール
## 5.1 本章で話すこと
以下のシステムコールを使用してストリームを操作することで入出力を実現します。
- read
> ストリームからバイト列を読み込む
- write
> ストリームにバイト列を書き込む
- open
> ストリームを作る
- close
> 用済みのストリームを始末する
## 5.2 ファイルディスクリプタ
プロセスがファイルを読み書きしたり他のプロセスとやりとりするときにはストリームを使います。  
このストリームをプログラムから扱うには、ファイルディスクリプタというものを使います。
### ファイルディスクリプタとは?
プログラムから見たファイルディスクリプタはただの整数値(int型)です。  
カーネルの中には、実際にストリーム(を管理するデータ型)があるのですが、ストリームを直接プロセスに見せるわけにはいきません。  
そこで、カーネルが持っているストリームと番号(i.e. ファイルディスクリプタ)を対応させることで、プロセスは番号からストリームを指定できるようになります。  
  
以上のように、ストリームと番号(ファイルディスクリプタ)の対応関係が重要になってきます。
## 5.3 標準入力、標準出力、標準エラー出力
ストリームとファイルディスクリプタの対応関係を知るにはどうすればいいでしょうか。  
一番簡単なのは、プロセスの開始時から使えることがわかっている既知のファイルディスクリプタを使うことです。  
  
シェルからプロセスが起動された場合、どのプロセスも以下の3つのストリームが用意されており、それに対応するファイルディスクリプタも固定されています。
- 標準入力
> ファイルディスクリプタ: 0
> マクロ名: STDIN_FILENO
- 標準出力
> ファイルディスクリプタ: 1
> マクロ名: STDOUT_FILENO
- 標準エラー出力
> ファイルディスクリプタ: 2
> マクロ名: STDERR_FILENO

## 5.3.1 標準入力と標準出力
コマンドを一般的に標準入力からデータを読み込み、処理結果を標準出力へ書き込むようになっています。  
標準入力はプログラムの入力元で、標準出力はプログラムの出力先だということです。  
`cat`: キーボード入力された文字列をモニタに出力する例
```
                          cat
+----------+  stream  +---------+  stream  +---------+
| keyboard | -------> | process | -------> | monitor |
+----------+  STDIN   +---------+  STEDOUT +---------+

```
`cat file`: ファイル内容をモニタに出力する例
```
                          cat
+----------+  stream  +---------+  stream  +---------+
|   file   | -------> | process | -------> | monitor |
+----------+  STDIN   +---------+  STEDOUT +---------+

```
ここですごいのは、catプロセスは自分がファイルからデータを読み込んでいることを知らないということです。  
というのも、ファイルとプロセス間のストリーム(ここでは標準入力のこと)はシェルが管理するのでプロセスは入力元について関知しません。  
※ ファイル-プロセス間のストリームのみに限る話ではありません。
